<!doctype html>
<html>
    <head>
        <title>Raiders of the Computronium Sphere</title>
        <script src="http://www.google.com/jsapi"></script>
        <script type="text/javascript" src="/Queue.compressed.js"></script>
        <script src="/rot.js"></script>
        <script src="/game.js"></script>
        <link rel="stylesheet" media="all" href="terminal.css">
    </head>
    <body onload="Game.init()">
        <h3><div id="locationDisp">ROTCS</div></h3>
        <div id="displayArea">&nbsp;</div>


        <aside class="help hidden">
          <section>
            <div>
              <span onclick="toggleHelp()" id="close">x</span>
              <h2>Keyboard shortcuts</h2>
              <div class="shortcuts">
                <p><strong>&lt;ctrl&gt; + s</strong> : Toggle CRT monitor flicker effect</p>
                <p><strong>&lt;esc&gt;</strong> : toggle this help menu</p>
              </div>
            </div>
            <div>
              <h2>What is this?</h2>
              <p>A Command-line terminal/shell running on top of HTML5 APIs.</p>
              <p>By: Eric Bidelman &lt;ericbidelman@chromium.org&gt;</p>
            </div>
          </section>
        </aside>

        <!--<div class="crt top"></div>-->
        <div class="interlace">&nbsp;</div>
        <div id="container" tabindex="2">&nbsp;</div>
        <!--<div class="crt bottom"></div>-->

        <script src="terminal.js"></script>
        <script>
          function toggleHelp() {
          document.querySelector('.help').classList.toggle('hidden');
          document.body.classList.toggle('dim');
          }

          (function() {
          var term = new Terminal('container');
          term.initFS(false, 1024 * 1024);
          
          if (document.location.hash) {
          var theme = document.location.hash.substring(1).split('=')[1];
          term.setTheme(theme);
          } else if (localStorage.theme) {
          term.setTheme(localStorage.theme);
          }
          
          document.body.addEventListener('keydown', function(e) {
          if (e.keyCode == 27) { // Esc
          toggleHelp();
          e.stopPropagation();
          e.preventDefault();
          }
          }, false);

          // Setup the DnD listeners for file drop.
          document.body.addEventListener('dragenter', function(e) {
          e.stopPropagation();
          e.preventDefault();
          this.classList.add('dropping');
          }, false);

          document.body.addEventListener('dragover', function(e) {
          e.stopPropagation();
          e.preventDefault();
          e.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
          }, false);

          document.body.addEventListener('dragleave', function(e) {
          this.classList.remove('dropping');
          }, false);
  
          document.body.addEventListener('drop', function(e) {
          e.stopPropagation();
          e.preventDefault();
          this.classList.remove('dropping');
          term.addDroppedFiles(e.dataTransfer.files);
          term.output('<div>File(s) added!</div>');
          }, false);
          })();
        </script>
    </body>
</html>
